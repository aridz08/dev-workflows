id: supabase-rls
name: "Supabase RLS"
description: "Row-Level Security enforcement and auth patterns"
version: "0.1.0"

rules:
  - id: supabase-rls-required
    scope: security
    severity: error
    content: |
      Every new table must have RLS policies before merging.
      Enable RLS with ALTER TABLE ... ENABLE ROW LEVEL SECURITY
      and create at least one policy per operation (SELECT, INSERT,
      UPDATE, DELETE) as needed.

  - id: supabase-auth-context
    scope: security
    severity: error
    content: |
      Always use auth.uid() in RLS policies to scope data to
      the authenticated user. Never rely on client-provided
      user IDs in queries.

  - id: supabase-no-service-role-client
    scope: security
    severity: error
    content: |
      Never expose the service_role key to the client.
      Use the anon key in browser code and the service_role key
      only in server-side or admin contexts.
